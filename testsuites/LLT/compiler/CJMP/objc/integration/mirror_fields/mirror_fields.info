// Copyright (c) Huawei Technologies Co., Ltd. 2025. All rights reserved.
// This source file is part of the Cangjie project, licensed under Apache-2.0
// with Runtime Library Exception.
//
// See https://cangjie-lang.cn/pages/LICENSE for license information.

// (CJNATIVE and not Windows) DEPENDENCE: ../Cangjie.h
// (CJNATIVE and not Windows) DEPENDENCE: ../%n
// (CJNATIVE and not Windows) RUN-EXEC-0: %cd %n && mkdir -p out
// (CJNATIVE and not Windows) RUN-EXEC-0: %cd %n && %compiler %compile_shared_lib_opt %overflowOpt -p src/cjworld %import_objc_interop -o out
// (CJNATIVE and Linux) RUN-EXEC-0: %cd %n && sed -i "s/\.dylib/\.so/g" objc-gen/*
// (CJNATIVE and Linux) RUN-EXEC-0: %cd %n && cat objc-gen/L.m
// (CJNATIVE and Linux) RUN-EXEC-0: %cd %n && %clang %objc_flags %objc_base_libs %objc_arc_opt src/objc/*.m objc-gen/*.m -o out/main -Lout %cangjie_runtime_link -I../ -Isrc/objc -Iobjc-gen %include_cangjie -lcjworld -lcangjie-runtime -ldl
// (CJNATIVE and Darwin) RUN-EXEC-0: %cd %n && %clang %modules_opt %objc_arc_opt src/objc/*.m objc-gen/*.m -o out/main -Lout %cangjie_runtime_link -I../ -Isrc/objc -Iobjc-gen %include_cangjie -lcjworld -lcangjie-runtime
// (CJNATIVE and not Windows) RUN-EXEC-PIPE: %cd %n/out && ./main | compare %f

/*SCAN-IN
objc: [M init]
objc: [K initWithVersion], version: 1
objc: [K init]
cj: L() init with version, version: 1
objc: [M init]
objc: [K initWithVersion], version: 1
objc: [K init]
cj: L() init with version, version: 1
cj: A()
x is 123 during A init
initialize m prop inside A, expect bunch of init calls
Accessing public field of Mirror through Impl: value of x is 123
Modified public field of Mirror through Impl: new value of x is 246
Calling method on Mirror class which is property of Mirror, through Impl: objc: [K foo]
Calling method on Impl class which is property of Mirror, through Impl: cj: L.bar()
Modifying inherited x from cj, new value: 369
Modifying m.x from cj, new value: 987
objc: [K initWithVersion], version: 2
Modifying m.k from cj, new version: 2
objc: [K init]
cj: L() init with version, version: 2
Modifying m.l from cj, new version: 2
*/
